"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[790],{790:function(e,a,t){t.d(a,{default:function(){return g}});var n=t(57437),s=t(2265),r=t(34029),c=t(92595),l=t(81973),i=t(46393),d=t(95252),o=t(99584),u=t(41671),x=t(76865),m=t(70525),f=t(3085),p=t(339),h=t(58113),j=t(18420),N=t(22835);function g(e){var a,t;let{accounts:g,transactions:v,onTransferComplete:b}=e,[y,w]=(0,s.useState)(""),[I,T]=(0,s.useState)(""),[C,S]=(0,s.useState)(""),[_,k]=(0,s.useState)(""),[F,Z]=(0,s.useState)([]),[B,D]=(0,s.useState)(null),[E,R]=(0,s.useState)([]),{createTransfer:A,validateTransferData:G,isTransferring:V}=function(){let[e,a]=(0,s.useState)(!1),{toast:t}=(0,j.pm)(),n=(0,h.e)();return{createTransfer:(0,s.useCallback)(async e=>{a(!0);try{let{outTransaction:a,inTransaction:s}=(0,p.uJ)(e),{error:r}=await n.from("transactions").insert(a);if(r)throw r;let{error:c}=await n.from("transactions").insert(s);if(c)throw c;return t({title:"Transfer\xeancia realizada!",description:"Valor de ".concat(e.amount," transferido com sucesso.")}),{success:!0}}catch(e){return console.error("Erro ao realizar transfer\xeancia:",e),t({variant:"destructive",title:"Erro na transfer\xeancia",description:"Tente novamente mais tarde."}),{success:!1,error:e}}finally{a(!1)}},[n,t]),validateTransferData:(0,s.useCallback)((e,a,t)=>(0,p.Fq)(e,a,t),[]),isTransferring:e}}();(0,s.useEffect)(()=>{Z(g.map(e=>(0,p.kp)(e,v))),D((0,p.rT)(g,v))},[g,v]);let O=async()=>{if(!y||!I||!C)return;let e=F.find(e=>e.accountId===y),a=F.find(e=>e.accountId===I);if(!e||!a)return;let t=parseFloat(C),n=G(e,a,t);if(!n.isValid){alert(n.reason);return}(await A({fromAccountId:y,toAccountId:I,amount:t,description:_||"Transfer\xeancia - ".concat(new Date().toLocaleDateString())})).success&&(w(""),T(""),S(""),k(""),null==b||b())},z=(e,a)=>{a?R([...E,e]):R(E.filter(a=>a!==e))},Y=E.length>0?(0,p.rT)(g,v,E):B;return(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)(r.Zb,{children:[(0,n.jsx)(r.Ol,{children:(0,n.jsxs)(r.ll,{className:"flex items-center gap-2",children:[(0,n.jsx)(d.Z,{className:"h-5 w-5 text-green-600"}),"Saldo Consolidado"]})}),(0,n.jsxs)(r.aY,{children:[(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"Saldo Total"}),(0,n.jsx)("p",{className:"text-2xl font-bold text-green-600",children:(0,N.xG)((null==Y?void 0:Y.totalBalance)||0)})]}),(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"Total Receitas"}),(0,n.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:(0,N.xG)((null==Y?void 0:Y.totalIncome)||0)})]}),(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"Total Despesas"}),(0,n.jsx)("p",{className:"text-2xl font-bold text-red-600",children:(0,N.xG)((null==Y?void 0:Y.totalExpenses)||0)})]})]}),(0,n.jsxs)("div",{className:"border-t pt-4",children:[(0,n.jsx)("p",{className:"text-sm font-medium mb-3",children:"Filtrar por contas:"}),(0,n.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:F.map(e=>(0,n.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,n.jsx)("input",{type:"checkbox",checked:E.includes(e.accountId),onChange:a=>z(e.accountId,a.target.checked),className:"rounded"}),(0,n.jsx)("span",{className:"text-sm",children:e.accountName})]},e.accountId))}),E.length>0&&(0,n.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:["Mostrando saldo de ",E.length," conta(s) selecionada(s)"]})]})]})]}),(0,n.jsxs)(r.Zb,{children:[(0,n.jsx)(r.Ol,{children:(0,n.jsxs)(r.ll,{className:"flex items-center gap-2",children:[(0,n.jsx)(o.Z,{className:"h-5 w-5 text-blue-600"}),"Transfer\xeancia entre Contas"]})}),(0,n.jsx)(r.aY,{children:(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(i._,{htmlFor:"fromAccount",children:"Conta de Origem"}),(0,n.jsxs)("select",{id:"fromAccount",value:y,onChange:e=>w(e.target.value),className:"w-full p-2 border rounded-md",children:[(0,n.jsx)("option",{value:"",children:"Selecione a conta de origem"}),F.map(e=>(0,n.jsxs)("option",{value:e.accountId,children:[e.accountName," -"," ",(0,N.xG)(e.currentBalance)]},e.accountId))]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(i._,{htmlFor:"toAccount",children:"Conta de Destino"}),(0,n.jsxs)("select",{id:"toAccount",value:I,onChange:e=>T(e.target.value),className:"w-full p-2 border rounded-md",children:[(0,n.jsx)("option",{value:"",children:"Selecione a conta de destino"}),F.map(e=>(0,n.jsxs)("option",{value:e.accountId,children:[e.accountName," -"," ",(0,N.xG)(e.currentBalance)]},e.accountId))]})]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(i._,{htmlFor:"amount",children:"Valor da Transfer\xeancia"}),(0,n.jsx)(l.I,{id:"amount",type:"number",step:"0.01",value:C,onChange:e=>S(e.target.value),placeholder:"0.00"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(i._,{htmlFor:"description",children:"Descri\xe7\xe3o (Opcional)"}),(0,n.jsx)(l.I,{id:"description",value:_,onChange:e=>k(e.target.value),placeholder:"Ex: Transfer\xeancia mensal"})]})]}),y&&I&&C&&(0,n.jsxs)("div",{className:"p-4 bg-blue-50 rounded-lg",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,n.jsx)(u.Z,{className:"h-4 w-4 text-green-600"}),(0,n.jsx)("span",{className:"font-medium",children:"Resumo da Transfer\xeancia"})]}),(0,n.jsxs)("p",{className:"text-sm text-gray-600",children:["Transferir"," ",(0,n.jsx)("strong",{children:(0,N.xG)(parseFloat(C))})," ","de"," ",(0,n.jsx)("strong",{children:null===(a=F.find(e=>e.accountId===y))||void 0===a?void 0:a.accountName})," ","para"," ",(0,n.jsx)("strong",{children:null===(t=F.find(e=>e.accountId===I))||void 0===t?void 0:t.accountName})]}),(()=>{let e=F.find(e=>e.accountId===y),a=F.find(e=>e.accountId===I);if(e&&a){let t=G(e,a,parseFloat(C));if(!t.isValid)return(0,n.jsxs)("p",{className:"text-sm text-red-600 mt-2 flex items-center gap-1",children:[(0,n.jsx)(x.Z,{className:"h-4 w-4"}),t.reason]})}return null})()]}),(0,n.jsx)(c.z,{onClick:O,disabled:!y||!I||!C||V,className:"w-full",children:V?"Transferindo...":"Realizar Transfer\xeancia"})]})})]}),(0,n.jsxs)(r.Zb,{children:[(0,n.jsx)(r.Ol,{children:(0,n.jsxs)(r.ll,{className:"flex items-center gap-2",children:[(0,n.jsx)(m.Z,{className:"h-5 w-5 text-purple-600"}),"Saldos das Contas"]})}),(0,n.jsx)(r.aY,{children:(0,n.jsx)("div",{className:"space-y-3",children:F.map(e=>(0,n.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(e.currentBalance>=0?"bg-green-500":"bg-red-500")}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"font-medium",children:e.accountName}),(0,n.jsxs)("p",{className:"text-sm text-gray-600",children:[e.transactionCount," transa\xe7\xf5es â€¢"," ",e.accountType]})]})]}),(0,n.jsxs)("div",{className:"text-right",children:[(0,n.jsx)("p",{className:"text-lg font-bold ".concat(e.currentBalance>=0?"text-green-600":"text-red-600"),children:(0,N.xG)(e.currentBalance)}),(0,n.jsxs)("div",{className:"flex gap-4 text-xs text-gray-500",children:[(0,n.jsxs)("span",{className:"flex items-center gap-1",children:[(0,n.jsx)(m.Z,{className:"h-3 w-3"}),(0,N.xG)(e.totalIncome)]}),(0,n.jsxs)("span",{className:"flex items-center gap-1",children:[(0,n.jsx)(f.Z,{className:"h-3 w-3"}),(0,N.xG)(e.totalExpenses)]})]})]})]},e.accountId))})})]})]})}},34029:function(e,a,t){t.d(a,{Ol:function(){return l},SZ:function(){return d},Zb:function(){return c},aY:function(){return o},eW:function(){return u},ll:function(){return i}});var n=t(57437),s=t(2265),r=t(22835);let c=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,n.jsx)("div",{ref:a,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...s})});c.displayName="Card";let l=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,n.jsx)("div",{ref:a,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",t),...s})});l.displayName="CardHeader";let i=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,n.jsx)("h3",{ref:a,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",t),...s})});i.displayName="CardTitle";let d=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,n.jsx)("p",{ref:a,className:(0,r.cn)("text-sm text-muted-foreground",t),...s})});d.displayName="CardDescription";let o=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,n.jsx)("div",{ref:a,className:(0,r.cn)("p-6 pt-0",t),...s})});o.displayName="CardContent";let u=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,n.jsx)("div",{ref:a,className:(0,r.cn)("flex items-center p-6 pt-0",t),...s})});u.displayName="CardFooter"},46393:function(e,a,t){t.d(a,{_:function(){return d}});var n=t(57437),s=t(2265),r=t(6394),c=t(90535),l=t(22835);let i=(0,c.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,n.jsx)(r.f,{ref:a,className:(0,l.cn)(i(),t),...s})});d.displayName=r.f.displayName},339:function(e,a,t){function n(e,a){let t=a.filter(a=>a.account_id===e.id),n=t.filter(e=>"income"===e.type).reduce((e,a)=>e+a.amount,0),s=t.filter(e=>"expense"===e.type).reduce((e,a)=>e+a.amount,0);return{accountId:e.id,accountName:e.name,accountType:e.type,currentBalance:n-s,totalIncome:n,totalExpenses:s,transactionCount:t.length}}function s(e,a,t){let s=e.map(e=>n(e,a)),r=t?s.filter(e=>t.includes(e.accountId)):s,c=r.reduce((e,a)=>e+a.currentBalance,0);return{totalBalance:c,totalIncome:r.reduce((e,a)=>e+a.totalIncome,0),totalExpenses:r.reduce((e,a)=>e+a.totalExpenses,0),accountBalances:s,filteredBalance:t?c:void 0,filteredAccounts:t}}function r(e,a,t){return t<=0?{isValid:!1,reason:"Valor deve ser maior que zero"}:e.currentBalance<t?{isValid:!1,reason:"Saldo insuficiente. Dispon\xedvel: ".concat(e.currentBalance.toFixed(2))}:e.accountId===a.accountId?{isValid:!1,reason:"N\xe3o \xe9 poss\xedvel transferir para a mesma conta"}:{isValid:!0}}function c(e){return{outTransaction:{account_id:e.fromAccountId,type:"expense",amount:e.amount,description:e.description||"Transfer\xeancia para ".concat(e.toAccountId),transaction_date:new Date().toISOString().split("T")[0],created_via:"transfer"},inTransaction:{account_id:e.toAccountId,type:"income",amount:e.amount,description:e.description||"Transfer\xeancia de ".concat(e.fromAccountId),transaction_date:new Date().toISOString().split("T")[0],created_via:"transfer"}}}t.d(a,{Fq:function(){return r},kp:function(){return n},rT:function(){return s},uJ:function(){return c}})}}]);