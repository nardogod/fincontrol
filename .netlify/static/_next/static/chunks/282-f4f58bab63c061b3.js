"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[282],{790:function(e,a,t){t.d(a,{default:function(){return N}});var s=t(57437),n=t(2265),r=t(34029),c=t(92595),l=t(81973),i=t(46393),d=t(95252),o=t(99584),x=t(41671),m=t(76865),u=t(70525),f=t(3085),h=t(339),p=t(58113),j=t(18420),g=t(22835);function N(e){var a,t;let{accounts:N,transactions:v,onTransferComplete:b}=e,[y,w]=(0,n.useState)(""),[T,I]=(0,n.useState)(""),[C,S]=(0,n.useState)(""),[Z,B]=(0,n.useState)(""),[_,k]=(0,n.useState)([]),[G,E]=(0,n.useState)(null),[F,R]=(0,n.useState)([]),{createTransfer:D,validateTransferData:O,isTransferring:A}=function(){let[e,a]=(0,n.useState)(!1),{toast:t}=(0,j.pm)(),s=(0,p.e)();return{createTransfer:(0,n.useCallback)(async e=>{a(!0);try{let{outTransaction:a,inTransaction:n}=(0,h.uJ)(e),{error:r}=await s.from("transactions").insert(a);if(r)throw r;let{error:c}=await s.from("transactions").insert(n);if(c)throw c;return t({title:"Transfer\xeancia realizada!",description:"Valor de ".concat(e.amount," transferido com sucesso.")}),{success:!0}}catch(e){return console.error("Erro ao realizar transfer\xeancia:",e),t({variant:"destructive",title:"Erro na transfer\xeancia",description:"Tente novamente mais tarde."}),{success:!1,error:e}}finally{a(!1)}},[s,t]),validateTransferData:(0,n.useCallback)((e,a,t)=>(0,h.Fq)(e,a,t),[]),isTransferring:e}}();(0,n.useEffect)(()=>{k(N.map(e=>(0,h.kp)(e,v))),E((0,h.rT)(N,v))},[N,v]);let V=async()=>{if(!y||!T||!C)return;let e=_.find(e=>e.accountId===y),a=_.find(e=>e.accountId===T);if(!e||!a)return;let t=parseFloat(C),s=O(e,a,t);if(!s.isValid){alert(s.reason);return}(await D({fromAccountId:y,toAccountId:T,amount:t,description:Z||"Transfer\xeancia - ".concat(new Date().toLocaleDateString())})).success&&(w(""),I(""),S(""),B(""),null==b||b())},z=(e,a)=>{a?R([...F,e]):R(F.filter(a=>a!==e))},Y=F.length>0?(0,h.rT)(N,v,F):G;return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)(r.Zb,{children:[(0,s.jsx)(r.Ol,{children:(0,s.jsxs)(r.ll,{className:"flex items-center gap-2",children:[(0,s.jsx)(d.Z,{className:"h-5 w-5 text-green-600"}),"Saldo Consolidado"]})}),(0,s.jsxs)(r.aY,{children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Saldo Total"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-green-600",children:(0,g.xG)((null==Y?void 0:Y.totalBalance)||0)})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Total Receitas"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:(0,g.xG)((null==Y?void 0:Y.totalIncome)||0)})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Total Despesas"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-red-600",children:(0,g.xG)((null==Y?void 0:Y.totalExpenses)||0)})]})]}),(0,s.jsxs)("div",{className:"border-t pt-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium mb-3",children:"Filtrar por contas:"}),(0,s.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:_.map(e=>(0,s.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:F.includes(e.accountId),onChange:a=>z(e.accountId,a.target.checked),className:"rounded"}),(0,s.jsx)("span",{className:"text-sm",children:e.accountName})]},e.accountId))}),F.length>0&&(0,s.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:["Mostrando saldo de ",F.length," conta(s) selecionada(s)"]})]})]})]}),(0,s.jsxs)(r.Zb,{children:[(0,s.jsx)(r.Ol,{children:(0,s.jsxs)(r.ll,{className:"flex items-center gap-2",children:[(0,s.jsx)(o.Z,{className:"h-5 w-5 text-blue-600"}),"Transfer\xeancia entre Contas"]})}),(0,s.jsx)(r.aY,{children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i._,{htmlFor:"fromAccount",children:"Conta de Origem"}),(0,s.jsxs)("select",{id:"fromAccount",value:y,onChange:e=>w(e.target.value),className:"w-full p-2 border rounded-md",children:[(0,s.jsx)("option",{value:"",children:"Selecione a conta de origem"}),_.map(e=>(0,s.jsxs)("option",{value:e.accountId,children:[e.accountName," -"," ",(0,g.xG)(e.currentBalance)]},e.accountId))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(i._,{htmlFor:"toAccount",children:"Conta de Destino"}),(0,s.jsxs)("select",{id:"toAccount",value:T,onChange:e=>I(e.target.value),className:"w-full p-2 border rounded-md",children:[(0,s.jsx)("option",{value:"",children:"Selecione a conta de destino"}),_.map(e=>(0,s.jsxs)("option",{value:e.accountId,children:[e.accountName," -"," ",(0,g.xG)(e.currentBalance)]},e.accountId))]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i._,{htmlFor:"amount",children:"Valor da Transfer\xeancia"}),(0,s.jsx)(l.I,{id:"amount",type:"number",step:"0.01",value:C,onChange:e=>S(e.target.value),placeholder:"0.00"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(i._,{htmlFor:"description",children:"Descri\xe7\xe3o (Opcional)"}),(0,s.jsx)(l.I,{id:"description",value:Z,onChange:e=>B(e.target.value),placeholder:"Ex: Transfer\xeancia mensal"})]})]}),y&&T&&C&&(0,s.jsxs)("div",{className:"p-4 bg-blue-50 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)(x.Z,{className:"h-4 w-4 text-green-600"}),(0,s.jsx)("span",{className:"font-medium",children:"Resumo da Transfer\xeancia"})]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["Transferir"," ",(0,s.jsx)("strong",{children:(0,g.xG)(parseFloat(C))})," ","de"," ",(0,s.jsx)("strong",{children:null===(a=_.find(e=>e.accountId===y))||void 0===a?void 0:a.accountName})," ","para"," ",(0,s.jsx)("strong",{children:null===(t=_.find(e=>e.accountId===T))||void 0===t?void 0:t.accountName})]}),(()=>{let e=_.find(e=>e.accountId===y),a=_.find(e=>e.accountId===T);if(e&&a){let t=O(e,a,parseFloat(C));if(!t.isValid)return(0,s.jsxs)("p",{className:"text-sm text-red-600 mt-2 flex items-center gap-1",children:[(0,s.jsx)(m.Z,{className:"h-4 w-4"}),t.reason]})}return null})()]}),(0,s.jsx)(c.z,{onClick:V,disabled:!y||!T||!C||A,className:"w-full",children:A?"Transferindo...":"Realizar Transfer\xeancia"})]})})]}),(0,s.jsxs)(r.Zb,{children:[(0,s.jsx)(r.Ol,{children:(0,s.jsxs)(r.ll,{className:"flex items-center gap-2",children:[(0,s.jsx)(u.Z,{className:"h-5 w-5 text-purple-600"}),"Saldos das Contas"]})}),(0,s.jsx)(r.aY,{children:(0,s.jsx)("div",{className:"space-y-3",children:_.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(e.currentBalance>=0?"bg-green-500":"bg-red-500")}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:e.accountName}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:[e.transactionCount," transa\xe7\xf5es •"," ",e.accountType]})]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("p",{className:"text-lg font-bold ".concat(e.currentBalance>=0?"text-green-600":"text-red-600"),children:(0,g.xG)(e.currentBalance)}),(0,s.jsxs)("div",{className:"flex gap-4 text-xs text-gray-500",children:[(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(u.Z,{className:"h-3 w-3"}),(0,g.xG)(e.totalIncome)]}),(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(f.Z,{className:"h-3 w-3"}),(0,g.xG)(e.totalExpenses)]})]})]})]},e.accountId))})})]})]})}},43091:function(e,a,t){t.d(a,{default:function(){return f}});var s=t(57437),n=t(2265),r=t(34029),c=t(95252),l=t(87769),i=t(42208),d=t(70525),o=t(3085),x=t(92595),m=t(339),u=t(22835);function f(e){let{accounts:a,transactions:t}=e,[f,h]=(0,n.useState)(!1),[p,j]=(0,n.useState)(null);return((0,n.useEffect)(()=>{a.length>0&&t.length>=0&&j((0,m.rT)(a,t))},[a,t]),p)?(0,s.jsxs)(r.Zb,{className:"mb-6 border-green-100 bg-gradient-to-r from-green-50 to-emerald-50",children:[(0,s.jsx)(r.Ol,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)(r.ll,{className:"flex items-center gap-2 text-lg",children:[(0,s.jsx)(c.Z,{className:"h-5 w-5 text-green-600"}),"Saldo Total Consolidado"]}),(0,s.jsxs)(x.z,{onClick:()=>h(!f),variant:"outline",size:"sm",className:"flex items-center gap-2",children:[f?(0,s.jsx)(l.Z,{className:"h-4 w-4"}):(0,s.jsx)(i.Z,{className:"h-4 w-4"}),f?"Mostrar":"Ocultar"]})]})}),(0,s.jsxs)(r.aY,{children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-2",children:[(0,s.jsx)(c.Z,{className:"h-5 w-5 text-green-600"}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Saldo Total"})]}),(0,s.jsx)("p",{className:"text-3xl font-bold text-green-600",children:f?"••••••":(0,u.xG)(p.totalBalance)}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[p.accountBalances.length," conta(s)"]})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-2",children:[(0,s.jsx)(d.Z,{className:"h-5 w-5 text-blue-600"}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Total Receitas"})]}),(0,s.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:f?"••••••":(0,u.xG)(p.totalIncome)}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Todas as contas"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-2",children:[(0,s.jsx)(o.Z,{className:"h-5 w-5 text-red-600"}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Total Despesas"})]}),(0,s.jsx)("p",{className:"text-2xl font-bold text-red-600",children:f?"••••••":(0,u.xG)(p.totalExpenses)}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Todas as contas"})]})]}),(0,s.jsxs)("div",{className:"mt-6 pt-4 border-t",children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Resumo por Conta:"}),(0,s.jsx)("div",{className:"space-y-2",children:p.accountBalances.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-2 bg-white rounded-lg border",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(e.currentBalance>=0?"bg-green-500":"bg-red-500")}),(0,s.jsx)("span",{className:"text-sm font-medium",children:e.accountName})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("p",{className:"text-sm font-bold ".concat(e.currentBalance>=0?"text-green-600":"text-red-600"),children:f?"••••":(0,u.xG)(e.currentBalance)}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:[e.transactionCount," transa\xe7\xf5es"]})]})]},e.accountId))})]})]})]}):(0,s.jsxs)(r.Zb,{className:"mb-6 border-green-100 bg-gradient-to-r from-green-50 to-emerald-50",children:[(0,s.jsx)(r.Ol,{children:(0,s.jsxs)(r.ll,{className:"flex items-center gap-2 text-lg",children:[(0,s.jsx)(c.Z,{className:"h-5 w-5 text-green-600"}),"Saldo Total Consolidado"]})}),(0,s.jsx)(r.aY,{children:(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Carregando saldos das contas..."})})]})}},34029:function(e,a,t){t.d(a,{Ol:function(){return l},SZ:function(){return d},Zb:function(){return c},aY:function(){return o},eW:function(){return x},ll:function(){return i}});var s=t(57437),n=t(2265),r=t(22835);let c=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)("div",{ref:a,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...n})});c.displayName="Card";let l=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)("div",{ref:a,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",t),...n})});l.displayName="CardHeader";let i=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)("h3",{ref:a,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",t),...n})});i.displayName="CardTitle";let d=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)("p",{ref:a,className:(0,r.cn)("text-sm text-muted-foreground",t),...n})});d.displayName="CardDescription";let o=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)("div",{ref:a,className:(0,r.cn)("p-6 pt-0",t),...n})});o.displayName="CardContent";let x=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)("div",{ref:a,className:(0,r.cn)("flex items-center p-6 pt-0",t),...n})});x.displayName="CardFooter"},46393:function(e,a,t){t.d(a,{_:function(){return d}});var s=t(57437),n=t(2265),r=t(6394),c=t(90535),l=t(22835);let i=(0,c.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)(r.f,{ref:a,className:(0,l.cn)(i(),t),...n})});d.displayName=r.f.displayName},339:function(e,a,t){function s(e,a){let t=a.filter(a=>a.account_id===e.id),s=t.filter(e=>"income"===e.type).reduce((e,a)=>e+a.amount,0),n=t.filter(e=>"expense"===e.type).reduce((e,a)=>e+a.amount,0);return{accountId:e.id,accountName:e.name,accountType:e.type,currentBalance:s-n,totalIncome:s,totalExpenses:n,transactionCount:t.length}}function n(e,a,t){let n=e.map(e=>s(e,a)),r=t?n.filter(e=>t.includes(e.accountId)):n,c=r.reduce((e,a)=>e+a.currentBalance,0);return{totalBalance:c,totalIncome:r.reduce((e,a)=>e+a.totalIncome,0),totalExpenses:r.reduce((e,a)=>e+a.totalExpenses,0),accountBalances:n,filteredBalance:t?c:void 0,filteredAccounts:t}}function r(e,a,t){return t<=0?{isValid:!1,reason:"Valor deve ser maior que zero"}:e.currentBalance<t?{isValid:!1,reason:"Saldo insuficiente. Dispon\xedvel: ".concat(e.currentBalance.toFixed(2))}:e.accountId===a.accountId?{isValid:!1,reason:"N\xe3o \xe9 poss\xedvel transferir para a mesma conta"}:{isValid:!0}}function c(e){return{outTransaction:{account_id:e.fromAccountId,type:"expense",amount:e.amount,description:e.description||"Transfer\xeancia para ".concat(e.toAccountId),transaction_date:new Date().toISOString().split("T")[0],created_via:"transfer"},inTransaction:{account_id:e.toAccountId,type:"income",amount:e.amount,description:e.description||"Transfer\xeancia de ".concat(e.fromAccountId),transaction_date:new Date().toISOString().split("T")[0],created_via:"transfer"}}}t.d(a,{Fq:function(){return r},kp:function(){return s},rT:function(){return n},uJ:function(){return c}})}}]);