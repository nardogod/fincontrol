(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[164],{81845:function(e,t,r){Promise.resolve().then(r.bind(r,98493))},92595:function(e,t,r){"use strict";r.d(t,{z:function(){return l}});var n=r(57437),o=r(2265),a=r(37053),s=r(90535),i=r(22835);let c=(0,s.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=o.forwardRef((e,t)=>{let{className:r,variant:o,size:s,asChild:l=!1,...d}=e,u=l?a.g7:"button";return(0,n.jsx)(u,{className:(0,i.cn)(c({variant:o,size:s,className:r})),ref:t,...d})});l.displayName="Button"},34029:function(e,t,r){"use strict";r.d(t,{Ol:function(){return i},SZ:function(){return l},Zb:function(){return s},aY:function(){return d},eW:function(){return u},ll:function(){return c}});var n=r(57437),o=r(2265),a=r(22835);let s=o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...o})});s.displayName="Card";let i=o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",r),...o})});i.displayName="CardHeader";let c=o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,n.jsx)("h3",{ref:t,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",r),...o})});c.displayName="CardTitle";let l=o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,n.jsx)("p",{ref:t,className:(0,a.cn)("text-sm text-muted-foreground",r),...o})});l.displayName="CardDescription";let d=o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("p-6 pt-0",r),...o})});d.displayName="CardContent";let u=o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("flex items-center p-6 pt-0",r),...o})});u.displayName="CardFooter"},18420:function(e,t,r){"use strict";r.d(t,{Am:function(){return u},pm:function(){return m}});var n=r(2265);let o=0,a=new Map,s=e=>{if(a.has(e))return;let t=setTimeout(()=>{a.delete(e),d({type:"REMOVE_TOAST",toastId:e})},5e3);a.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?s(r):e.toasts.forEach(e=>{s(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},c=[],l={toasts:[]};function d(e){l=i(l,e),c.forEach(e=>{e(l)})}function u(e){let{...t}=e,r=(o=(o+1)%Number.MAX_SAFE_INTEGER).toString(),n=()=>d({type:"DISMISS_TOAST",toastId:r});return d({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||n()}}}),{id:r,dismiss:n,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function m(){let[e,t]=n.useState(l);return n.useEffect(()=>(c.push(t),()=>{let e=c.indexOf(t);e>-1&&c.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},98493:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return p}});var n=r(57437),o=r(2265),a=r(99376),s=r(58113),i=r(92595),c=r(34029),l=r(18420),d=r(89345),u=r(60044),m=r(92369),f=r(30401),h=r(32489);function p(){let e=(0,a.useParams)(),t=(0,a.useRouter)(),{toast:r}=(0,l.pm)(),p=(0,s.e)(),[v,g]=(0,o.useState)(null),[x,b]=(0,o.useState)(!0),[N,y]=(0,o.useState)(!1);(0,o.useEffect)(()=>{j()},[]);let j=async()=>{try{b(!0),console.log("\uD83D\uDD0D Buscando convite com token:",e.token);try{let{data:t,error:n}=await p.from("account_invites").select("*").eq("token",e.token).single();if(t&&!n){if(console.log("✅ Convite encontrado no banco:",t),"pending"===t.status){g({id:t.id,accountName:"Conta Compartilhada",inviterName:"Usu\xe1rio",role:t.role,status:t.status});return}console.log("❌ Convite j\xe1 foi processado:",t.status),r({variant:"destructive",title:"Convite j\xe1 processado",description:"Este convite j\xe1 foi ".concat("accepted"===t.status?"aceito":"rejeitado",".")});return}console.log("❌ Convite n\xe3o encontrado no banco:",n)}catch(e){console.log("\uD83D\uDD04 Banco n\xe3o dispon\xedvel, usando localStorage")}let t=JSON.parse(localStorage.getItem("email_invites")||"[]");console.log("\uD83D\uDCE7 Convites dispon\xedveis no localStorage:",t);let n=t.find(t=>t.inviteLink.includes(e.token)||t.id===e.token||t.token===e.token);if(n)console.log("✅ Convite encontrado no localStorage:",n),g({id:n.id,accountName:n.accountName,inviterName:n.inviterName,role:n.role,status:n.status});else{console.log("❌ Convite n\xe3o encontrado em nenhum lugar"),console.log("\uD83D\uDD04 Criando convite de demonstra\xe7\xe3o como fallback");let t={id:"demo_".concat(e.token),accountName:"Conta de Demonstra\xe7\xe3o",inviterName:"Usu\xe1rio Demo",role:"member",status:"pending"};g(t),console.log("✅ Convite de demonstra\xe7\xe3o criado:",t)}}catch(e){console.error("Error loading invite:",e),r({variant:"destructive",title:"Erro",description:"N\xe3o foi poss\xedvel carregar o convite."})}finally{b(!1)}},w=async()=>{if(v)try{y(!0);let{data:n}=await p.auth.getUser();if(!n.user){r({variant:"destructive",title:"Login necess\xe1rio",description:"Voc\xea precisa estar logado para aceitar o convite."}),t.push("/login");return}console.log("✅ Aceitando convite...");try{let{data:t,error:r}=await p.from("account_invites").select("*").eq("token",e.token).eq("status","pending").single();if(t&&!r){let{error:e}=await p.from("account_invites").update({status:"accepted"}).eq("id",t.id);if(e)throw e;let{error:r}=await p.from("account_members").insert({account_id:t.account_id,user_id:n.user.id,role:t.role});if(r)throw r;console.log("✅ Convite aceito no banco de dados"),console.log("✅ Usu\xe1rio adicionado como membro da conta")}}catch(a){console.log("\uD83D\uDD04 Banco n\xe3o dispon\xedvel, usando localStorage");let e=JSON.parse(localStorage.getItem("email_invites")||"[]"),t=e.findIndex(e=>e.id===v.id);-1!==t&&(e[t].status="accepted",localStorage.setItem("email_invites",JSON.stringify(e)),console.log("✅ Status do convite atualizado no localStorage"));let r=JSON.parse(localStorage.getItem("account_members")||"[]"),o={id:"member_".concat(Date.now()),account_id:"account_".concat(Date.now()),account_name:v.accountName,user_id:n.user.id,user_email:n.user.email,role:v.role,created_at:new Date().toISOString()};r.push(o),localStorage.setItem("account_members",JSON.stringify(r)),console.log("✅ Membro adicionado \xe0 conta no localStorage:",o)}r({title:"Convite aceito!",description:'Voc\xea agora faz parte da conta "'.concat(v.accountName,'".')}),setTimeout(()=>{t.push("/dashboard")},1500)}catch(e){console.error("Error accepting invite:",e),r({variant:"destructive",title:"Erro",description:"N\xe3o foi poss\xedvel aceitar o convite."})}finally{y(!1)}},k=async()=>{if(v)try{y(!0);let e=JSON.parse(localStorage.getItem("email_invites")||"[]"),n=e.findIndex(e=>e.id===v.id);-1!==n&&(e[n].status="rejected",localStorage.setItem("email_invites",JSON.stringify(e)),r({title:"Convite rejeitado",description:"O convite foi rejeitado com sucesso."}),t.push("/dashboard"))}catch(e){console.error("Error rejecting invite:",e),r({variant:"destructive",title:"Erro",description:"N\xe3o foi poss\xedvel rejeitar o convite."})}finally{y(!1)}};return x?(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):v?"pending"!==v.status?(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,n.jsx)(c.Zb,{className:"w-full max-w-md",children:(0,n.jsxs)(c.aY,{className:"p-6 text-center",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"accepted"===v.status?"Convite j\xe1 aceito":"Convite rejeitado"}),(0,n.jsx)("p",{className:"text-gray-600 mb-4",children:"Este convite j\xe1 foi processado."}),(0,n.jsx)(i.z,{onClick:()=>t.push("/dashboard"),children:"Ir para Dashboard"})]})})}):(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,n.jsxs)(c.Zb,{className:"w-full max-w-md",children:[(0,n.jsxs)(c.Ol,{className:"text-center",children:[(0,n.jsx)("div",{className:"mx-auto mb-4 w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:(0,n.jsx)(d.Z,{className:"h-6 w-6 text-blue-600"})}),(0,n.jsx)(c.ll,{className:"text-2xl",children:"Convite para Conta"})]}),(0,n.jsxs)(c.aY,{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Voc\xea foi convidado para participar da conta"}),(0,n.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,n.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-2",children:[(0,n.jsx)(u.Z,{className:"h-5 w-5 text-blue-600"}),(0,n.jsx)("span",{className:"font-semibold text-blue-800",children:v.accountName})]}),(0,n.jsxs)("div",{className:"flex items-center justify-center gap-2 text-sm text-blue-600 mb-2",children:[(0,n.jsx)(m.Z,{className:"h-4 w-4"}),(0,n.jsxs)("span",{children:["Como ","owner"===v.role?"Propriet\xe1rio":"Membro"]})]}),(0,n.jsxs)("div",{className:"text-xs text-gray-600",children:["Convidado por: ",(0,n.jsx)("strong",{children:v.inviterName})]})]})]}),(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsx)("h4",{className:"font-semibold",children:"O que voc\xea pode fazer:"}),(0,n.jsxs)("ul",{className:"text-sm text-gray-600 space-y-1",children:[(0,n.jsx)("li",{children:"• Visualizar transa\xe7\xf5es da conta"}),(0,n.jsx)("li",{children:"• Adicionar novas transa\xe7\xf5es"}),(0,n.jsx)("li",{children:"• Ver relat\xf3rios e gr\xe1ficos"}),(0,n.jsx)("li",{children:"• Gerenciar categorias"})]})]}),(0,n.jsxs)("div",{className:"flex gap-3",children:[(0,n.jsx)(i.z,{onClick:w,disabled:N,className:"flex-1 bg-green-600 hover:bg-green-700",children:N?(0,n.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f.Z,{className:"h-4 w-4 mr-2"}),"Aceitar"]})}),(0,n.jsxs)(i.z,{onClick:k,disabled:N,variant:"outline",className:"flex-1 border-red-300 text-red-600 hover:bg-red-50",children:[(0,n.jsx)(h.Z,{className:"h-4 w-4 mr-2"}),"Rejeitar"]})]})]})]})}):(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,n.jsx)(c.Zb,{className:"w-full max-w-md",children:(0,n.jsxs)(c.aY,{className:"p-6 text-center",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Convite n\xe3o encontrado"}),(0,n.jsx)("p",{className:"text-gray-600 mb-4",children:"Este convite pode ter expirado ou j\xe1 foi processado."}),(0,n.jsx)(i.z,{onClick:()=>t.push("/dashboard"),children:"Ir para Dashboard"})]})})})}},58113:function(e,t,r){"use strict";r.d(t,{e:function(){return o}});var n=r(20338);function o(){return(0,n.createBrowserClient)("https://ncysankyxvwsuwbqmmtj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5jeXNhbmt5eHZ3c3V3YnFtbXRqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA2MDA4NTAsImV4cCI6MjA3NjE3Njg1MH0.ZKKnsB3cCN6eJnvCNy3Wqehp9VmgeceXRHo4uwPQRb4")}o()},22835:function(e,t,r){"use strict";r.d(t,{XY:function(){return c},cn:function(){return a},p6:function(){return i},xG:function(){return s}});var n=r(61994),o=r(53335);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,o.m6)((0,n.W)(t))}function s(e){return new Intl.NumberFormat("sv-SE",{style:"currency",currency:"SEK",minimumFractionDigits:2}).format(e)}function i(e){let t="string"==typeof e?new Date(e):e;return new Intl.DateTimeFormat("sv-SE").format(t)}function c(e){return["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"][e-1]||""}},43664:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(2265),o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),s=(e,t)=>{let r=(0,n.forwardRef)((r,s)=>{let{color:i="currentColor",size:c=24,strokeWidth:l=2,absoluteStrokeWidth:d,className:u="",children:m,...f}=r;return(0,n.createElement)("svg",{ref:s,...o,width:c,height:c,stroke:i,strokeWidth:d?24*Number(l)/Number(c):l,className:["lucide","lucide-".concat(a(e)),u].join(" "),...f},[...t.map(e=>{let[t,r]=e;return(0,n.createElement)(t,r)}),...Array.isArray(m)?m:[m]])});return r.displayName="".concat(e),r}},60044:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(43664).Z)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]])},30401:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(43664).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},89345:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(43664).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},92369:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(43664).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},32489:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(43664).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},99376:function(e,t,r){"use strict";var n=r(35475);r.o(n,"useParams")&&r.d(t,{useParams:function(){return n.useParams}}),r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}})}},function(e){e.O(0,[828,971,117,744],function(){return e(e.s=81845)}),_N_E=e.O()}]);