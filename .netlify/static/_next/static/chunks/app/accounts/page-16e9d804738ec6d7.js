(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[423],{71037:function(e,t,a){Promise.resolve().then(a.bind(a,77589))},77589:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Q}});var s=a(57437),r=a(99376),n=a(27648),l=a(58113),i=a(2265),d=a(92595),c=a(34029);let o=(0,a(43664).Z)("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);var m=a(99397),u=a(99637),x=a(9592),f=a(18930),p=a(73966),h=a(98575),g=a(49027),j=a(6741),N=a(37053),y="AlertDialog",[v,w]=(0,p.b)(y,[g.p8]),b=(0,g.p8)(),C=e=>{let{__scopeAlertDialog:t,...a}=e,r=b(t);return(0,s.jsx)(g.fC,{...r,...a,modal:!0})};C.displayName=y;var R=i.forwardRef((e,t)=>{let{__scopeAlertDialog:a,...r}=e,n=b(a);return(0,s.jsx)(g.xz,{...n,...r,ref:t})});R.displayName="AlertDialogTrigger";var D=e=>{let{__scopeAlertDialog:t,...a}=e,r=b(t);return(0,s.jsx)(g.h_,{...r,...a})};D.displayName="AlertDialogPortal";var A=i.forwardRef((e,t)=>{let{__scopeAlertDialog:a,...r}=e,n=b(a);return(0,s.jsx)(g.aV,{...n,...r,ref:t})});A.displayName="AlertDialogOverlay";var _="AlertDialogContent",[k,E]=v(_),S=(0,N.sA)("AlertDialogContent"),z=i.forwardRef((e,t)=>{let{__scopeAlertDialog:a,children:r,...n}=e,l=b(a),d=i.useRef(null),c=(0,h.e)(t,d),o=i.useRef(null);return(0,s.jsx)(g.jm,{contentName:_,titleName:Z,docsSlug:"alert-dialog",children:(0,s.jsx)(k,{scope:a,cancelRef:o,children:(0,s.jsxs)(g.VY,{role:"alertdialog",...l,...n,ref:c,onOpenAutoFocus:(0,j.Mj)(n.onOpenAutoFocus,e=>{var t;e.preventDefault(),null===(t=o.current)||void 0===t||t.focus({preventScroll:!0})}),onPointerDownOutside:e=>e.preventDefault(),onInteractOutside:e=>e.preventDefault(),children:[(0,s.jsx)(S,{children:r}),(0,s.jsx)(Y,{contentRef:d})]})})})});z.displayName=_;var Z="AlertDialogTitle",O=i.forwardRef((e,t)=>{let{__scopeAlertDialog:a,...r}=e,n=b(a);return(0,s.jsx)(g.Dx,{...n,...r,ref:t})});O.displayName=Z;var q="AlertDialogDescription",T=i.forwardRef((e,t)=>{let{__scopeAlertDialog:a,...r}=e,n=b(a);return(0,s.jsx)(g.dk,{...n,...r,ref:t})});T.displayName=q;var F=i.forwardRef((e,t)=>{let{__scopeAlertDialog:a,...r}=e,n=b(a);return(0,s.jsx)(g.x8,{...n,...r,ref:t})});F.displayName="AlertDialogAction";var M="AlertDialogCancel",I=i.forwardRef((e,t)=>{let{__scopeAlertDialog:a,...r}=e,{cancelRef:n}=E(M,a),l=b(a),i=(0,h.e)(t,n);return(0,s.jsx)(g.x8,{...l,...r,ref:i})});I.displayName=M;var Y=e=>{let{contentRef:t}=e,a="`".concat(_,"` requires a description for the component to be accessible for screen reader users.\n\nYou can add a description to the `").concat(_,"` by passing a `").concat(q,"` component as a child, which also benefits sighted users by adding visible context to the dialog.\n\nAlternatively, you can use your own component as a description by assigning it an `id` and passing the same value to the `aria-describedby` prop in `").concat(_,"`. If the description is confusing or duplicative for sighted users, you can use the `@radix-ui/react-visually-hidden` primitive as a wrapper around your description component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/alert-dialog");return i.useEffect(()=>{var e;document.getElementById(null===(e=t.current)||void 0===e?void 0:e.getAttribute("aria-describedby"))||console.warn(a)},[a,t]),null},P=a(22835);let V=i.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(A,{className:(0,P.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r,ref:t})});V.displayName=A.displayName;let H=i.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsxs)(D,{children:[(0,s.jsx)(V,{}),(0,s.jsx)(z,{ref:t,className:(0,P.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...r})]})});H.displayName=z.displayName;let $=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,P.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};$.displayName="AlertDialogHeader";let B=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,P.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};B.displayName="AlertDialogFooter";let L=i.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(O,{ref:t,className:(0,P.cn)("text-lg font-semibold",a),...r})});L.displayName=O.displayName;let U=i.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(T,{ref:t,className:(0,P.cn)("text-sm text-muted-foreground",a),...r})});U.displayName=T.displayName;let W=i.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(F,{ref:t,className:(0,P.cn)((0,d.d)(),a),...r})});W.displayName=F.displayName;let G=i.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(I,{ref:t,className:(0,P.cn)((0,d.d)({variant:"outline"}),"mt-2 sm:mt-0",a),...r})});G.displayName=I.displayName;var J=a(18420);function K(e){let{accountId:t,accountName:a,onDeleted:r}=e,[n,c]=(0,i.useState)(!1),{deleteAccount:o,isDeleting:m}=function(){let[e,t]=(0,i.useState)(!1),{toast:a}=(0,J.pm)(),s=(0,l.e)();return{deleteAccount:(0,i.useCallback)(async e=>{t(!0);try{let{data:t,error:r}=await s.from("transactions").select("id").eq("account_id",e).limit(1);if(r)throw r;if(t&&t.length>0)return a({variant:"destructive",title:"N\xe3o \xe9 poss\xedvel deletar",description:"Esta conta possui transa\xe7\xf5es associadas. Remova as transa\xe7\xf5es primeiro."}),{success:!1,error:"Conta possui transa\xe7\xf5es"};let{error:n}=await s.from("accounts").delete().eq("id",e);if(n)throw n;return a({title:"Conta deletada!",description:"A conta foi removida com sucesso."}),{success:!0}}catch(e){return console.error("Erro ao deletar conta:",e),a({variant:"destructive",title:"Erro ao deletar conta",description:"Tente novamente mais tarde."}),{success:!1,error:e}}finally{t(!1)}},[s,a]),isDeleting:e}}(),u=async()=>{(await o(t)).success&&(c(!1),null==r||r())};return(0,s.jsxs)(C,{open:n,onOpenChange:c,children:[(0,s.jsx)(R,{asChild:!0,children:(0,s.jsxs)(d.z,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700 hover:bg-red-50",disabled:m,children:[(0,s.jsx)(f.Z,{className:"h-3 w-3 mr-1"}),"Deletar"]})}),(0,s.jsxs)(H,{children:[(0,s.jsxs)($,{children:[(0,s.jsx)(L,{children:"Deletar Conta"}),(0,s.jsxs)(U,{children:['Tem certeza que deseja deletar a conta "',a,'"? Esta a\xe7\xe3o n\xe3o pode ser desfeita.',(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)("strong",{children:"Nota:"})," Apenas contas sem transa\xe7\xf5es podem ser deletadas."]})]}),(0,s.jsxs)(B,{children:[(0,s.jsx)(G,{children:"Cancelar"}),(0,s.jsx)(W,{onClick:u,className:"bg-red-600 hover:bg-red-700",disabled:m,children:m?"Deletando...":"Deletar"})]})]})]})}function Q(){let e=(0,l.e)(),[t,a]=(0,i.useState)(null),[f,p]=(0,i.useState)([]),[h,g]=(0,i.useState)([]),[j,N]=(0,i.useState)(!0);(0,i.useEffect)(()=>{(async()=>{try{let{data:{user:t}}=await e.auth.getUser();a(t)}catch(e){console.error("Error getting user:",e)}})()},[e]),(0,i.useEffect)(()=>{t&&(async()=>{try{let{data:a,error:s}=await e.from("accounts").select("*").eq("user_id",t.id).order("created_at",{ascending:!1});if(s)throw s;p(a||[]);let{data:r,error:n}=await e.from("transactions").select("*").eq("user_id",t.id).order("transaction_date",{ascending:!1});if(n)throw n;g(r||[])}catch(e){console.error("Error fetching data:",e)}finally{N(!1)}})()},[t,e]);let y=()=>{t&&(async()=>{try{let{data:a,error:s}=await e.from("accounts").select("*").eq("user_id",t.id).order("created_at",{ascending:!1});if(s)throw s;p(a||[]);let{data:r,error:n}=await e.from("transactions").select("*").eq("user_id",t.id).order("transaction_date",{ascending:!1});if(n)throw n;g(r||[])}catch(e){console.error("Error fetching data:",e)}})()};if(j)return(0,s.jsx)(x.default,{user:t,children:(0,s.jsx)("div",{className:"p-6",children:(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsx)("div",{className:"text-gray-500",children:"Carregando contas..."})})})});t||(0,r.redirect)("/login");let v=e=>h?h.filter(t=>t.account_id===e).reduce((e,t)=>"income"===t.type?e+t.amount:e-t.amount,0):0,w=h?h.reduce((e,t)=>"income"===t.type?e+t.amount:e-t.amount,0):0;return(0,s.jsx)(x.default,{user:t,children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[(0,s.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Minhas Contas"}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:[(0,s.jsxs)(d.z,{variant:"outline",className:"flex items-center gap-2 text-xs sm:text-sm",children:[(0,s.jsx)(o,{className:"h-4 w-4 sm:h-5 sm:w-5"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Recuperar"})]}),(0,s.jsx)(d.z,{asChild:!0,className:"w-full sm:w-auto",children:(0,s.jsxs)(n.default,{href:"/accounts/new",className:"flex items-center justify-center gap-2",children:[(0,s.jsx)(m.Z,{className:"h-4 w-4 sm:h-5 sm:w-5"}),"Nova Conta"]})})]})]}),(0,s.jsxs)(c.Zb,{className:"mb-6 border-green-100 bg-gradient-to-r from-green-50 to-emerald-50",children:[(0,s.jsx)(c.Ol,{children:(0,s.jsxs)(c.ll,{className:"flex items-center gap-2 text-lg",children:[(0,s.jsx)(u.Z,{className:"h-5 w-5 text-green-600"}),"Saldo Total Consolidado"]})}),(0,s.jsxs)(c.aY,{children:[(0,s.jsxs)("div",{className:"text-3xl font-bold text-green-600",children:["R$ ",w.toFixed(2)]}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Soma de todas as suas contas"})]})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:f.map(e=>{let t=v(e.id),a=t>=0;return(0,s.jsxs)(c.Zb,{className:"border-l-4 ".concat(a?"border-l-green-500 bg-green-50":"border-l-red-500 bg-red-50"),children:[(0,s.jsxs)(c.Ol,{className:"pb-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(c.ll,{className:"text-lg font-semibold text-gray-900",children:e.name}),(0,s.jsx)("div",{className:"flex gap-1",children:(0,s.jsx)(K,{accountId:e.id,accountName:e.name,onDeleted:y})})]}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:e.description||"Sem descri\xe7\xe3o"})]}),(0,s.jsx)(c.aY,{children:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Saldo Atual:"}),(0,s.jsxs)("span",{className:"text-lg font-bold ".concat(a?"text-green-600":"text-red-600"),children:["R$ ",t.toFixed(2)]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-gray-500",children:"Tipo:"}),(0,s.jsx)("span",{className:"font-medium capitalize",children:e.type})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-gray-500",children:"Status:"}),(0,s.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(e.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.is_active?"Ativa":"Inativa"})]})]})})]},e.id)})}),0===f.length&&(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(u.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhuma conta encontrada"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:"Comece criando sua primeira conta para organizar suas finan\xe7as."}),(0,s.jsx)(d.z,{asChild:!0,children:(0,s.jsxs)(n.default,{href:"/accounts/new",className:"flex items-center gap-2",children:[(0,s.jsx)(m.Z,{className:"h-4 w-4"}),"Criar Primeira Conta"]})})]})]})})}},34029:function(e,t,a){"use strict";a.d(t,{Ol:function(){return i},SZ:function(){return c},Zb:function(){return l},aY:function(){return o},eW:function(){return m},ll:function(){return d}});var s=a(57437),r=a(2265),n=a(22835);let l=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...r})});l.displayName="Card";let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",a),...r})});i.displayName="CardHeader";let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",a),...r})});d.displayName="CardTitle";let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",a),...r})});c.displayName="CardDescription";let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",a),...r})});o.displayName="CardContent";let m=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",a),...r})});m.displayName="CardFooter"},18930:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(43664).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])}},function(e){e.O(0,[828,972,494,783,707,21,971,117,744],function(){return e(e.s=71037)}),_N_E=e.O()}]);