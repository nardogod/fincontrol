(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[220],{14386:function(e,a,s){Promise.resolve().then(s.bind(s,9592)),Promise.resolve().then(s.bind(s,12599)),Promise.resolve().then(s.t.bind(s,72972,23))},12599:function(e,a,s){"use strict";s.d(a,{default:function(){return D}});var t=s(57437),l=s(2265),n=s(99376),i=s(27648),r=s(92595),o=s(81973),d=s(60967),c=s(58113),u=s(18420),x=s(22835),m=s(46393),h=s(3805),p=s(91351),j=s(29133);let v=p.Ry({type:p.Km(["income","expense"]),amount:p.Rx().positive("O valor deve ser maior que zero"),category_id:p.Z_().uuid("Selecione uma categoria"),account_id:p.Z_().uuid("Selecione uma conta"),transaction_date:p.Z_().min(1,"Selecione uma data"),description:p.Z_().optional()});function g(e){let{transaction:a,isOpen:s,onClose:n,onSuccess:i,accounts:p,categories:g}=e,f=(0,c.e)(),[y,N]=(0,l.useState)(!1),[b,w]=(0,l.useState)({type:"expense",amount:"",category_id:"",account_id:"",transaction_date:"",description:""});(0,l.useEffect)(()=>{a&&w({type:a.type,amount:a.amount.toString(),category_id:a.category_id||"",account_id:a.account_id,transaction_date:a.transaction_date,description:a.description||""})},[a]);let k=g.filter(e=>e.type===b.type),C=async e=>{if(e.preventDefault(),a){N(!0),console.log("\uD83D\uDD27 Editando transa\xe7\xe3o:",a.id),console.log("\uD83D\uDCDD Dados do formul\xe1rio:",b);try{let e=v.parse({...b,amount:parseFloat(b.amount),description:b.description||void 0});console.log("✅ Dados validados:",e);let{data:s,error:t}=await f.from("transactions").update(e).eq("id",a.id).select();if(console.log("\uD83D\uDCBE Resultado da atualiza\xe7\xe3o:",{data:s,error:t}),t)throw console.error("❌ Erro ao atualizar:",t),t;(0,u.Am)({title:"Transa\xe7\xe3o atualizada!",description:"A transa\xe7\xe3o foi editada com sucesso."}),i(),n()}catch(e){e instanceof j.jm?(0,u.Am)({variant:"destructive",title:"Erro de valida\xe7\xe3o",description:e.errors[0].message}):(console.error("Error updating transaction:",e),(0,u.Am)({variant:"destructive",title:"Erro ao atualizar transa\xe7\xe3o",description:"Tente novamente mais tarde."}))}finally{N(!1)}}};return(0,t.jsx)(h.Vq,{open:s,onOpenChange:n,children:(0,t.jsxs)(h.cZ,{className:"sm:max-w-[500px]",children:[(0,t.jsxs)(h.fK,{children:[(0,t.jsx)(h.$N,{children:"Editar Transa\xe7\xe3o"}),(0,t.jsx)(h.Be,{children:"Modifique os detalhes da transa\xe7\xe3o abaixo."})]}),(0,t.jsxs)("form",{onSubmit:C,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(m._,{children:"Tipo de Transa\xe7\xe3o"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("button",{type:"button",onClick:()=>{w({...b,type:"income",category_id:""})},className:(0,x.cn)("flex items-center justify-center gap-2 rounded-xl border-2 p-3 transition-all","income"===b.type?"border-green-500 bg-green-50 text-green-700":"border-slate-200 bg-white text-slate-600 hover:border-slate-300"),children:[(0,t.jsx)("span",{className:"text-xl",children:"\uD83D\uDCB0"}),(0,t.jsx)("span",{className:"font-semibold",children:"Entrada"})]}),(0,t.jsxs)("button",{type:"button",onClick:()=>{w({...b,type:"expense",category_id:""})},className:(0,x.cn)("flex items-center justify-center gap-2 rounded-xl border-2 p-3 transition-all","expense"===b.type?"border-red-500 bg-red-50 text-red-700":"border-slate-200 bg-white text-slate-600 hover:border-slate-300"),children:[(0,t.jsx)("span",{className:"text-xl",children:"\uD83D\uDCB8"}),(0,t.jsx)("span",{className:"font-semibold",children:"Sa\xedda"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(m._,{htmlFor:"amount",children:"Valor (SEK)"}),(0,t.jsx)(o.I,{id:"amount",type:"number",step:"0.01",placeholder:"0.00",value:b.amount,onChange:e=>w({...b,amount:e.target.value}),required:!0,disabled:y})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(m._,{htmlFor:"category",children:"Categoria"}),(0,t.jsxs)(d.Ph,{value:b.category_id,onValueChange:e=>w({...b,category_id:e}),disabled:y,children:[(0,t.jsx)(d.i4,{children:(0,t.jsx)(d.ki,{placeholder:"Selecione uma categoria"})}),(0,t.jsx)(d.Bw,{children:k.map(e=>(0,t.jsx)(d.Ql,{value:e.id,children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{children:e.icon}),(0,t.jsx)("span",{children:e.name})]})},e.id))})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(m._,{htmlFor:"account",children:"Conta"}),(0,t.jsxs)(d.Ph,{value:b.account_id,onValueChange:e=>w({...b,account_id:e}),disabled:y,children:[(0,t.jsx)(d.i4,{children:(0,t.jsx)(d.ki,{placeholder:"Selecione uma conta"})}),(0,t.jsx)(d.Bw,{children:p.map(e=>(0,t.jsxs)(d.Ql,{value:e.id,children:[e.icon," ",e.name]},e.id))})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(m._,{htmlFor:"date",children:"Data"}),(0,t.jsx)(o.I,{id:"date",type:"date",value:b.transaction_date,onChange:e=>w({...b,transaction_date:e.target.value}),required:!0,disabled:y})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(m._,{htmlFor:"description",children:"Descri\xe7\xe3o (opcional)"}),(0,t.jsx)(o.I,{id:"description",type:"text",placeholder:"Ex: Compras do supermercado",value:b.description,onChange:e=>w({...b,description:e.target.value}),disabled:y})]}),(0,t.jsxs)(h.cN,{children:[(0,t.jsx)(r.z,{type:"button",variant:"outline",onClick:n,disabled:y,children:"Cancelar"}),(0,t.jsx)(r.z,{type:"submit",className:"bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700",disabled:y,children:y?"Salvando...":"Salvar Altera\xe7\xf5es"})]})]})]})})}var f=s(43664);let y=(0,f.Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),N=(0,f.Z)("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]),b=(0,f.Z)("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]),w=(0,f.Z)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);var k=s(18930);let C=(0,f.Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);var _=s(10407);function D(e){let{transactions:a,accounts:s,categories:m,currentPage:h,totalPages:p}=e,j=(0,n.useRouter)(),v=(0,c.e)(),[f,D]=(0,l.useState)("all"),[S,z]=(0,l.useState)("all"),[T,E]=(0,l.useState)("all"),[Z,Q]=(0,l.useState)("all"),[V,P]=(0,l.useState)(""),[B,q]=(0,l.useState)(null),[A,R]=(0,l.useState)(null),[L,F]=(0,l.useState)(!1),M=async e=>{if(confirm("Tem certeza que deseja deletar esta transa\xe7\xe3o?")){q(e);try{let{error:a}=await v.from("transactions").delete().eq("id",e);if(a)throw a;(0,u.Am)({title:"Transa\xe7\xe3o deletada",description:"A transa\xe7\xe3o foi removida com sucesso."}),j.refresh()}catch(e){console.error("Error deleting transaction:",e),(0,u.Am)({variant:"destructive",title:"Erro ao deletar",description:"Tente novamente mais tarde."})}finally{q(null)}}},O=e=>{R(e),F(!0)},H=()=>{let e=new URLSearchParams;"all"!==f&&e.set("account",f),"all"!==S&&e.set("category",S),"all"!==T&&e.set("type",T),"all"!==Z&&e.set("user",Z),V.trim()&&e.set("search",V.trim()),j.push("/transactions?".concat(e.toString()))},I=a.filter(e=>{var a,s,t;if(!V.trim())return!0;let l=V.toLowerCase();return(null===(a=e.description)||void 0===a?void 0:a.toLowerCase().includes(l))||(null===(s=e.category)||void 0===s?void 0:s.name.toLowerCase().includes(l))||(null===(t=e.account)||void 0===t?void 0:t.name.toLowerCase().includes(l))||e.amount.toString().includes(l)}),K=()=>{D("all"),z("all"),E("all"),Q("all"),j.push("/transactions")};return 0===a.length?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:[(0,t.jsxs)(d.Ph,{value:f,onValueChange:D,children:[(0,t.jsx)(d.i4,{children:(0,t.jsx)(d.ki,{placeholder:"Todas as contas"})}),(0,t.jsxs)(d.Bw,{children:[(0,t.jsx)(d.Ql,{value:"all",children:"Todas as contas"}),s.map(e=>(0,t.jsxs)(d.Ql,{value:e.id,children:[e.icon," ",e.name]},e.id))]})]}),(0,t.jsxs)(d.Ph,{value:S,onValueChange:z,children:[(0,t.jsx)(d.i4,{children:(0,t.jsx)(d.ki,{placeholder:"Todas as categorias"})}),(0,t.jsxs)(d.Bw,{children:[(0,t.jsx)(d.Ql,{value:"all",children:"Todas as categorias"}),m.map(e=>(0,t.jsxs)(d.Ql,{value:e.id,children:[e.icon," ",e.name]},e.id))]})]}),(0,t.jsxs)(d.Ph,{value:T,onValueChange:E,children:[(0,t.jsx)(d.i4,{children:(0,t.jsx)(d.ki,{placeholder:"Todos os tipos"})}),(0,t.jsxs)(d.Bw,{children:[(0,t.jsx)(d.Ql,{value:"all",children:"Todos os tipos"}),(0,t.jsx)(d.Ql,{value:"income",children:"Entradas"}),(0,t.jsx)(d.Ql,{value:"expense",children:"Sa\xeddas"})]})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(r.z,{onClick:H,variant:"default",children:"Aplicar Filtros"}),(0,t.jsx)(r.z,{onClick:K,variant:"outline",children:"Limpar"})]}),(0,t.jsx)("div",{className:"py-12 text-center",children:(0,t.jsx)("p",{className:"text-slate-500",children:"Nenhuma transa\xe7\xe3o encontrada"})})]}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[(0,t.jsxs)(d.Ph,{value:f,onValueChange:D,children:[(0,t.jsx)(d.i4,{children:(0,t.jsx)(d.ki,{placeholder:"Todas as contas"})}),(0,t.jsxs)(d.Bw,{children:[(0,t.jsx)(d.Ql,{value:"all",children:"Todas as contas"}),s.map(e=>(0,t.jsxs)(d.Ql,{value:e.id,children:[e.icon," ",e.name]},e.id))]})]}),(0,t.jsxs)(d.Ph,{value:S,onValueChange:z,children:[(0,t.jsx)(d.i4,{children:(0,t.jsx)(d.ki,{placeholder:"Todas as categorias"})}),(0,t.jsxs)(d.Bw,{children:[(0,t.jsx)(d.Ql,{value:"all",children:"Todas as categorias"}),m.map(e=>(0,t.jsxs)(d.Ql,{value:e.id,children:[e.icon," ",e.name]},e.id))]})]}),(0,t.jsxs)(d.Ph,{value:T,onValueChange:E,children:[(0,t.jsx)(d.i4,{children:(0,t.jsx)(d.ki,{placeholder:"Todos os tipos"})}),(0,t.jsxs)(d.Bw,{children:[(0,t.jsx)(d.Ql,{value:"all",children:"Todos os tipos"}),(0,t.jsx)(d.Ql,{value:"income",children:"Entradas"}),(0,t.jsx)(d.Ql,{value:"expense",children:"Sa\xeddas"})]})]})]}),a.some(e=>{var a;return null===(a=e.account)||void 0===a?void 0:a.is_shared})&&(0,t.jsx)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:(0,t.jsxs)(d.Ph,{value:Z,onValueChange:Q,children:[(0,t.jsx)(d.i4,{children:(0,t.jsx)(d.ki,{placeholder:"Todos os usu\xe1rios"})}),(0,t.jsxs)(d.Bw,{children:[(0,t.jsx)(d.Ql,{value:"all",children:"Todos os usu\xe1rios"}),Array.from(new Set(a.filter(e=>{var a;return null===(a=e.user)||void 0===a?void 0:a.email}).map(e=>{var a,s,t;return{id:(null===(a=e.user)||void 0===a?void 0:a.email)||"",name:(null===(s=e.user)||void 0===s?void 0:s.full_name)||(null===(t=e.user)||void 0===t?void 0:t.email)||""}}).filter(e=>e.id&&e.name))).map(e=>(0,t.jsxs)(d.Ql,{value:e.id,children:["\uD83D\uDC64 ",e.name]},e.id))]})]})}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-slate-400"}),(0,t.jsx)(o.I,{placeholder:"Buscar por descri\xe7\xe3o, categoria, conta ou valor...",value:V,onChange:e=>P(e.target.value),className:"pl-10"})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row",children:[(0,t.jsx)(r.z,{onClick:H,variant:"default",className:"w-full sm:w-auto",children:"Aplicar Filtros"}),(0,t.jsx)(r.z,{onClick:K,variant:"outline",className:"w-full sm:w-auto",children:"Limpar"})]}),(0,t.jsx)("div",{className:"space-y-2",children:I.map(e=>{var a,s,l,n,i;return(0,t.jsxs)("div",{className:"flex flex-col gap-4 rounded-lg border bg-white p-4 transition-shadow hover:shadow-md sm:flex-row sm:items-center sm:justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl ".concat("income"===e.type?"bg-green-100 text-green-600":"bg-red-100 text-red-600"),children:"income"===e.type?(0,t.jsx)(N,{className:"h-6 w-6"}):(0,t.jsx)(b,{className:"h-6 w-6"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("p",{className:"font-semibold text-slate-900",children:(null===(a=e.category)||void 0===a?void 0:a.name)||"Sem categoria"}),(0,t.jsx)("span",{className:"text-sm text-slate-500",children:null===(s=e.category)||void 0===s?void 0:s.icon})]}),(0,t.jsx)("p",{className:"text-sm text-slate-600",children:e.description||"Sem descri\xe7\xe3o"}),(0,t.jsxs)("p",{className:"text-xs text-slate-500",children:[(0,x.p6)(e.transaction_date)," •"," ",null===(l=e.account)||void 0===l?void 0:l.icon," ",null===(n=e.account)||void 0===n?void 0:n.name,e.user&&(0,t.jsxs)("span",{className:"ml-2 text-blue-600",children:["• Por ",e.user.full_name||e.user.email]}),e.created_via&&(0,t.jsxs)("span",{className:"ml-1 text-xs bg-gray-100 px-1 rounded",children:["via ",e.created_via]}),(null===(i=e.account)||void 0===i?void 0:i.is_shared)&&(0,t.jsx)("span",{className:"ml-2 text-green-600",children:"• Conta compartilhada"})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("p",{className:"text-lg font-bold ".concat("income"===e.type?"text-green-600":"text-red-600"),children:["income"===e.type?"+":"-",(0,x.xG)(e.amount)]}),(0,t.jsxs)("div",{className:"flex gap-1",children:[(0,t.jsx)(r.z,{variant:"ghost",size:"icon",onClick:()=>O(e),title:"Editar transa\xe7\xe3o",children:(0,t.jsx)(w,{className:"h-4 w-4 text-blue-500"})}),(0,t.jsx)(r.z,{variant:"ghost",size:"icon",onClick:()=>M(e.id),disabled:B===e.id,title:"Deletar transa\xe7\xe3o",children:(0,t.jsx)(k.Z,{className:"h-4 w-4 text-red-500"})})]})]})]},e.id)})}),0===I.length&&a.length>0&&(0,t.jsxs)("div",{className:"py-12 text-center",children:[(0,t.jsxs)("p",{className:"text-slate-500",children:['Nenhuma transa\xe7\xe3o encontrada para "',V,'"']}),(0,t.jsx)(r.z,{variant:"outline",onClick:()=>P(""),className:"mt-2",children:"Limpar busca"})]}),p>1&&(0,t.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,t.jsx)(i.default,{href:"/transactions?page=".concat(h-1),className:1===h?"pointer-events-none opacity-50":"",children:(0,t.jsx)(r.z,{variant:"outline",size:"icon",disabled:1===h,children:(0,t.jsx)(C,{className:"h-4 w-4"})})}),(0,t.jsxs)("span",{className:"text-sm text-slate-600",children:["P\xe1gina ",h," de ",p]}),(0,t.jsx)(i.default,{href:"/transactions?page=".concat(h+1),className:h===p?"pointer-events-none opacity-50":"",children:(0,t.jsx)(r.z,{variant:"outline",size:"icon",disabled:h===p,children:(0,t.jsx)(_.Z,{className:"h-4 w-4"})})})]}),(0,t.jsx)(g,{transaction:A,isOpen:L,onClose:()=>{F(!1),R(null)},onSuccess:()=>{console.log("\uD83D\uDD04 Recarregando dados ap\xf3s edi\xe7\xe3o..."),window.location.reload()},accounts:s,categories:m})]})}},3805:function(e,a,s){"use strict";s.d(a,{$N:function(){return p},Be:function(){return j},Vq:function(){return o},cN:function(){return h},cZ:function(){return x},fK:function(){return m},hg:function(){return d}});var t=s(57437),l=s(2265),n=s(49027),i=s(32489),r=s(22835);let o=n.fC,d=n.xz,c=n.h_;n.x8;let u=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(n.aV,{ref:a,className:(0,r.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...l})});u.displayName=n.aV.displayName;let x=l.forwardRef((e,a)=>{let{className:s,children:l,...o}=e;return(0,t.jsxs)(c,{children:[(0,t.jsx)(u,{}),(0,t.jsxs)(n.VY,{ref:a,className:(0,r.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...o,children:[l,(0,t.jsxs)(n.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,t.jsx)(i.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});x.displayName=n.VY.displayName;let m=e=>{let{className:a,...s}=e;return(0,t.jsx)("div",{className:(0,r.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),...s})};m.displayName="DialogHeader";let h=e=>{let{className:a,...s}=e;return(0,t.jsx)("div",{className:(0,r.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...s})};h.displayName="DialogFooter";let p=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(n.Dx,{ref:a,className:(0,r.cn)("text-lg font-semibold leading-none tracking-tight",s),...l})});p.displayName=n.Dx.displayName;let j=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(n.dk,{ref:a,className:(0,r.cn)("text-sm text-muted-foreground",s),...l})});j.displayName=n.dk.displayName},10407:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(43664).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},18930:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(43664).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])}},function(e){e.O(0,[569,972,338,494,945,542,703,707,351,980,971,117,744],function(){return e(e.s=14386)}),_N_E=e.O()}]);